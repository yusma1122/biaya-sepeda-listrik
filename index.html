<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkulator Biaya Sepeda Listrik</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'ebike': '#10b981',
                        'motor': '#ef4444',
                        'compare': '#3b82f6'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 py-6">
            <h1 class="text-3xl font-bold text-gray-900">🚴‍♂️ Kalkulator Biaya Sepeda Listrik</h1>
            <p class="mt-2 text-gray-600">Analisis lengkap biaya operasional dan ROI untuk investasi e-bike Anda</p>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-4 py-8">
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Main Calculator -->
            <div class="flex-1 space-y-6 lg:mr-80">
                <!-- E-bike Specifications -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-l-4 border-ebike">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4">📋 Spesifikasi E-bike</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Voltase Baterai (V)</label>
                            <input type="number" id="voltage" value="48" min="24" max="72" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ebike">
                            <div class="text-xs text-gray-600 mt-2 p-2 bg-gray-50 rounded">
                                <p class="font-medium text-gray-700 mb-1">💡 Apa itu Voltase?</p>
                                <p>Voltase adalah "kekuatan listrik" baterai e-bike Anda. Seperti tekanan air dalam selang - semakin tinggi voltase, semakin kuat tenaga motor. Biasanya: 36V (standar), 48V (sedang), 60V+ (kencang). Cek stiker di baterai atau buku manual.</p>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Kapasitas Baterai (Ah)</label>
                            <input type="number" id="capacity" value="10" min="5" max="50" step="0.1" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ebike">
                            <div class="text-xs text-gray-600 mt-2 p-2 bg-gray-50 rounded">
                                <p class="font-medium text-gray-700 mb-1">💡 Apa itu Kapasitas (Ah)?</p>
                                <p>Ah = Ampere Hour, artinya "berapa lama baterai bisa menyuplai listrik". Ibarat tangki bensin - semakin besar Ah, semakin jauh bisa jalan. Contoh: 10Ah (jarak pendek), 20Ah (jarak sedang), 30Ah+ (jarak jauh). Tertulis di baterai atau spesifikasi.</p>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Range per Charge (km)</label>
                            <input type="number" id="range" value="40" min="20" max="150" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ebike">
                            <div class="text-xs text-gray-600 mt-2 p-2 bg-gray-50 rounded">
                                <p class="font-medium text-gray-700 mb-1">💡 Apa itu Range?</p>
                                <p>Range = jarak tempuh sekali charge penuh. Seperti motor bensin dengan tangki penuh bisa berapa km. Biasanya tertulis di brosur (contoh: "60km sekali charge"). PENTING: ini jarak ideal - di praktik bisa lebih pendek tergantung jalanan dan cara berkendara.</p>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Tarif Listrik (Rp/kWh)</label>
                            <input type="number" id="electricity_rate" value="1467" min="500" max="3000" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ebike">
                            <div class="text-xs text-gray-600 mt-2 p-2 bg-gray-50 rounded">
                                <p class="font-medium text-gray-700 mb-1">💡 Apa itu Tarif Listrik?</p>
                                <p>Ini harga listrik PLN per kWh (kilo Watt hour). Seperti harga bensin per liter, tapi untuk listrik. Cek tagihan listrik rumah Anda, biasanya tertulis "Rp/kWh". Standar PLN: Rp 1.467/kWh (2025). Kalau tidak tahu, pakai angka default ini.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Usage Pattern -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-l-4 border-ebike">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4">🚗 Pola Penggunaan</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Jarak Harian (km)</label>
                            <input type="number" id="daily_distance" value="20" min="1" max="200" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ebike">
                            <div class="text-xs text-gray-600 mt-2 p-2 bg-blue-50 rounded">
                                <p class="font-medium text-gray-700 mb-1">💡 Jarak yang Anda tempuh setiap hari</p>
                                <p>Contoh: rumah ke kantor PP = 15km, berarti total harian 30km. Atau rumah-pasar-sekolah-rumah = 25km. Hitung semua perjalanan dalam 1 hari, bukan sekali jalan saja.</p>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Hari Aktif per Minggu</label>
                            <input type="number" id="active_days" value="5" min="1" max="7" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ebike">
                            <div class="text-xs text-gray-600 mt-2 p-2 bg-blue-50 rounded">
                                <p class="font-medium text-gray-700 mb-1">💡 Berapa hari Anda pakai e-bike dalam seminggu?</p>
                                <p>Contoh: kerja Senin-Sabtu = 6 hari. Atau cuma weekdays = 5 hari. Kalau kadang libur atau WFH, kurangi jadi 4-5 hari. Ini untuk hitung biaya yang realistis.</p>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Mode Berkendara</label>
                            <select id="driving_mode" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ebike">
                                <option value="0.9" selected>Eco (90% efisiensi)</option>
                                <option value="0.8">Normal (80% efisiensi)</option>
                                <option value="0.7">Sport (70% efisiensi)</option>
                            </select>
                            <div class="text-xs text-gray-600 mt-2 p-2 bg-blue-50 rounded">
                                <p class="font-medium text-gray-700 mb-1">💡 Cara Anda berkendara sehari-hari</p>
                                <p><strong>Eco:</strong> Pelan-pelan, hemat baterai, cocok jarak jauh<br>
                                <strong>Normal:</strong> Standar, seimbang kecepatan & hemat<br>
                                <strong>Sport:</strong> Ngebut, boros baterai tapi cepat sampai</p>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Kondisi Medan</label>
                            <select id="terrain" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ebike">
                                <option value="1.0" selected>Datar (100%)</option>
                                <option value="1.2">Campuran (120%)</option>
                                <option value="1.5">Berbukit (150%)</option>
                            </select>
                            <div class="text-xs text-gray-600 mt-2 p-2 bg-blue-50 rounded">
                                <p class="font-medium text-gray-700 mb-1">💡 Seperti apa jalanan yang biasa Anda lewati?</p>
                                <p><strong>Datar:</strong> Jalan lurus, tidak ada tanjakan (hemat baterai)<br>
                                <strong>Campuran:</strong> Ada naik-turun, tapi tidak terlalu curam<br>
                                <strong>Berbukit:</strong> Banyak tanjakan curam (boros baterai)</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ROI Analysis -->
                <div class="bg-white rounded-lg shadow-lg p-6 border-l-4 border-compare">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4">💰 Analisis ROI & Balik Modal</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Harga Beli E-bike (Rp)</label>
                            <input type="number" id="ebike_price" value="15000000" min="5000000" max="50000000" step="100000" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-compare">
                            <div class="text-xs text-gray-600 mt-2 p-2 bg-purple-50 rounded">
                                <p class="font-medium text-gray-700 mb-1">💡 Total investasi awal untuk beli e-bike</p>
                                <p>Masukkan harga beli e-bike lengkap dengan aksesoris. Contoh: Rp 15.000.000 untuk e-bike kelas menengah, atau Rp 8.500.000 untuk entry level.</p>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Biaya Bensin Motor per Minggu (Rp)</label>
                            <input type="number" id="weekly_fuel_cost" value="150000" min="50000" max="500000" step="5000" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-motor">
                            <div class="text-xs text-gray-600 mt-2 p-2 bg-red-50 rounded">
                                <p class="font-medium text-gray-700 mb-1">💡 Berapa Anda habiskan bensin motor sekarang?</p>
                                <p>Hitung total biaya bensin motor per minggu. Contoh: isi 3x @Rp 50.000 = Rp 150.000/minggu. Atau kalau isi harian Rp 20.000 x 7 = Rp 140.000/minggu.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cara Menghitung -->
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg shadow-lg p-6 border-l-4 border-blue-500">
                    <button id="toggle-calculation" class="w-full text-left focus:outline-none group" onclick="toggleCalculationDetails()">
                        <div class="flex items-center justify-between">
                            <h2 class="text-xl font-semibold text-gray-900">🧮 Cara Menghitung (Rumus yang Kami Pakai)</h2>
                            <div class="flex items-center space-x-2">
                                <span id="toggle-text" class="text-sm text-blue-600 font-medium">Klik untuk lihat detail</span>
                                <svg id="toggle-icon" class="w-5 h-5 text-blue-600 transform transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </div>
                        </div>
                    </button>
                    
                    <div id="calculation-details" class="hidden mt-4">
                        <p class="text-sm text-gray-600 mb-4">Penjelasan detail setiap langkah perhitungan dengan contoh menggunakan data default:</p>
                    
                    <div class="space-y-4">
                        <div class="bg-white p-4 rounded-lg border border-blue-200">
                            <h3 class="font-semibold text-blue-800 mb-3">1️⃣ Menghitung Energi Baterai (kWh)</h3>
                            <div class="text-sm text-gray-700 space-y-2">
                                <p><strong>Rumus:</strong> <code class="bg-gray-100 px-2 py-1 rounded">Energi (kWh) = Voltase × Kapasitas ÷ 1000</code></p>
                                
                                <div class="bg-blue-50 p-3 rounded border-l-4 border-blue-300">
                                    <p><strong>📍 Dari mana angkanya:</strong></p>
                                    <p>• <strong>Voltase (48V)</strong> = Input Anda di "Voltase Baterai"</p>
                                    <p>• <strong>Kapasitas (10Ah)</strong> = Input Anda di "Kapasitas Baterai"</p>
                                    <p>• <strong>÷ 1000</strong> = Konversi dari Watt hour (Wh) ke kiloWatt hour (kWh)</p>
                                </div>
                                
                                <p><strong>Contoh Perhitungan:</strong></p>
                                <p><code class="bg-yellow-100 px-2 py-1 rounded">48V × 10Ah ÷ 1000 = 0.48 kWh</code></p>
                                <p><strong>💡 Artinya:</strong> Baterai Anda bisa menyimpan 0.48 kWh energi listrik (seperti tangki bensin 0.48 liter)</p>
                            </div>
                        </div>

                        <div class="bg-white p-4 rounded-lg border border-blue-200">
                            <h3 class="font-semibold text-blue-800 mb-3">2️⃣ Menghitung Biaya Charging</h3>
                            <div class="text-sm text-gray-700 space-y-2">
                                <p><strong>Rumus:</strong> <code class="bg-gray-100 px-2 py-1 rounded">Biaya = (Energi ÷ Efisiensi Charging) × Tarif PLN</code></p>
                                
                                <div class="bg-blue-50 p-3 rounded border-l-4 border-blue-300">
                                    <p><strong>📍 Dari mana angkanya:</strong></p>
                                    <p>• <strong>Energi (0.48 kWh)</strong> = Hasil dari langkah 1</p>
                                    <p>• <strong>Efisiensi Charging (0.92 = 92%)</strong> = Standar industri (charger tidak 100% efisien)</p>
                                    <p>• <strong>Tarif PLN (Rp 1.467)</strong> = Input Anda di "Tarif Listrik"</p>
                                </div>
                                
                                <p><strong>Mengapa ada Efisiensi 92%?</strong></p>
                                <p class="text-xs bg-yellow-50 p-2 rounded border">Saat ngecas, tidak semua listrik dari PLN masuk ke baterai. Ada yang hilang jadi panas di charger (sekitar 8%). Jadi kalau baterai butuh 0.48 kWh, PLN harus supply 0.52 kWh.</p>
                                
                                <p><strong>Contoh Perhitungan:</strong></p>
                                <p><code class="bg-yellow-100 px-2 py-1 rounded">(0.48 ÷ 0.92) × Rp 1.467 = 0.52 kWh × Rp 1.467 = Rp 765</code></p>
                                <p><strong>💡 Artinya:</strong> Sekali ngecas full habis Rp 765 listrik</p>
                            </div>
                        </div>

                        <div class="bg-white p-4 rounded-lg border border-blue-200">
                            <h3 class="font-semibold text-blue-800 mb-3">3️⃣ Menghitung Jarak Real (Praktis)</h3>
                            <div class="text-sm text-gray-700 space-y-2">
                                <p><strong>Rumus:</strong> <code class="bg-gray-100 px-2 py-1 rounded">Jarak Real = Range × Efisiensi Mode × (1 ÷ Faktor Medan)</code></p>
                                
                                <div class="bg-blue-50 p-3 rounded border-l-4 border-blue-300">
                                    <p><strong>📍 Dari mana angkanya:</strong></p>
                                    <p>• <strong>Range (40 km)</strong> = Input Anda di "Range per Charge" (jarak ideal pabrik)</p>
                                    <p>• <strong>Efisiensi Mode (0.9 = 90%)</strong> = Pilihan Anda di "Mode Berkendara"</p>
                                    <p>• <strong>Faktor Medan (1.0)</strong> = Pilihan Anda di "Kondisi Medan"</p>
                                </div>
                                
                                <p><strong>Mengapa jarak berkurang?</strong></p>
                                <div class="text-xs bg-yellow-50 p-2 rounded border space-y-1">
                                    <p>• <strong>Mode Eco (90%)</strong> = Hemat, tapi tetap ada loss 10%</p>
                                    <p>• <strong>Mode Normal (80%)</strong> = Standar, loss 20%</p>
                                    <p>• <strong>Mode Sport (70%)</strong> = Ngebut, boros 30%</p>
                                    <p>• <strong>Medan Datar (1.0x)</strong> = Normal</p>
                                    <p>• <strong>Medan Campuran (1.2x)</strong> = Baterai 20% lebih boros</p>
                                    <p>• <strong>Medan Berbukit (1.5x)</strong> = Baterai 50% lebih boros</p>
                                </div>
                                
                                <p><strong>Contoh Perhitungan:</strong></p>
                                <p><code class="bg-yellow-100 px-2 py-1 rounded">40 km × 0.9 × (1 ÷ 1.0) = 36 km real</code></p>
                                <p><strong>💡 Artinya:</strong> Yang tertulis 40km di brosur, praktiknya cuma 36km</p>
                            </div>
                        </div>

                        <div class="bg-white p-4 rounded-lg border border-blue-200">
                            <h3 class="font-semibold text-blue-800 mb-3">4️⃣ Menghitung Biaya per km</h3>
                            <div class="text-sm text-gray-700 space-y-2">
                                <p><strong>Rumus:</strong> <code class="bg-gray-100 px-2 py-1 rounded">Biaya per km = Biaya Charge ÷ Jarak Real</code></p>
                                
                                <div class="bg-blue-50 p-3 rounded border-l-4 border-blue-300">
                                    <p><strong>📍 Dari mana angkanya:</strong></p>
                                    <p>• <strong>Biaya Charge (Rp 765)</strong> = Hasil dari langkah 2</p>
                                    <p>• <strong>Jarak Real (36 km)</strong> = Hasil dari langkah 3</p>
                                </div>
                                
                                <p><strong>Contoh Perhitungan:</strong></p>
                                <p><code class="bg-yellow-100 px-2 py-1 rounded">Rp 765 ÷ 36 km = Rp 21,26 per km</code></p>
                                <p><strong>💡 Artinya:</strong> Setiap 1 km jalan, biaya listrik Rp 21 (vs bensin motor ~Rp 500-800/km)</p>
                            </div>
                        </div>

                        <div class="bg-white p-4 rounded-lg border border-blue-200">
                            <h3 class="font-semibold text-blue-800 mb-3">5️⃣ Menghitung Biaya Bulanan</h3>
                            <div class="text-sm text-gray-700 space-y-2">
                                <p><strong>Rumus:</strong> <code class="bg-gray-100 px-2 py-1 rounded">Biaya Bulanan = Biaya per km × Jarak Harian × Hari Aktif × (52÷12)</code></p>
                                
                                <div class="bg-blue-50 p-3 rounded border-l-4 border-blue-300">
                                    <p><strong>📍 Dari mana angkanya:</strong></p>
                                    <p>• <strong>Biaya per km (Rp 21,26)</strong> = Hasil dari langkah 4</p>
                                    <p>• <strong>Jarak Harian (20 km)</strong> = Input Anda di "Jarak Harian"</p>
                                    <p>• <strong>Hari Aktif (5 hari)</strong> = Input Anda di "Hari Aktif per Minggu"</p>
                                    <p>• <strong>(52÷12 = 4.33)</strong> = Konversi minggu ke bulan (52 minggu/tahun ÷ 12 bulan)</p>
                                </div>
                                
                                <p><strong>Contoh Perhitungan:</strong></p>
                                <p><code class="bg-yellow-100 px-2 py-1 rounded">Rp 21,26 × 20 km × 5 hari × 4.33 = Rp 9.213 per bulan</code></p>
                            </div>
                        </div>

                        <div class="bg-white p-4 rounded-lg border border-green-200">
                            <h3 class="font-semibold text-green-800 mb-3">6️⃣ Menghitung ROI Balik Modal</h3>
                            <div class="text-sm text-gray-700 space-y-2">
                                <p><strong>Rumus:</strong> <code class="bg-gray-100 px-2 py-1 rounded">Waktu Balik Modal = Harga E-bike ÷ Penghematan per Bulan</code></p>
                                
                                <div class="bg-green-50 p-3 rounded border-l-4 border-green-300">
                                    <p><strong>📍 Dari mana angkanya:</strong></p>
                                    <p>• <strong>Harga E-bike (Rp 15.000.000)</strong> = Input Anda di "Harga Beli E-bike"</p>
                                    <p>• <strong>Biaya Motor per Bulan</strong> = Bensin per Minggu × (52÷12) = Rp 150.000 × 4.33 = Rp 650.000</p>
                                    <p>• <strong>Biaya E-bike per Bulan (Rp 9.213)</strong> = Hasil dari langkah 5</p>
                                    <p>• <strong>Penghematan</strong> = Rp 650.000 - Rp 9.213 = Rp 640.787 per bulan</p>
                                </div>
                                
                                <p><strong>Contoh Perhitungan:</strong></p>
                                <p><code class="bg-yellow-100 px-2 py-1 rounded">Rp 15.000.000 ÷ Rp 640.787 = 23.4 bulan</code></p>
                                <p><strong>💡 Artinya:</strong> Investasi e-bike balik modal dalam 23.4 bulan (hampir 2 tahun)</p>
                                
                                <div class="mt-3 p-2 bg-green-100 rounded border">
                                    <p class="font-medium text-green-800">🎯 Kesimpulan:</p>
                                    <p class="text-green-700">Setelah 2 tahun, Anda mulai untung bersih Rp 640.787 setiap bulan!</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Debug Info -->
                <div class="bg-yellow-50 rounded-lg p-6 border border-yellow-200">
                    <h3 class="text-lg font-semibold text-yellow-800 mb-3">🔍 Debug Info (untuk cek perhitungan)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                        <div>
                            <p><strong>Kapasitas Baterai:</strong> <span id="debug-capacity">-</span> kWh</p>
                            <p><strong>Efisiensi Charging:</strong> <span id="debug-charging">92%</span></p>
                            <p><strong>Efisiensi Mode:</strong> <span id="debug-mode">-</span>%</p>
                            <p><strong>Faktor Medan:</strong> <span id="debug-terrain">-</span></p>
                        </div>
                        <div>
                            <p><strong>Total Efisiensi:</strong> <span id="debug-total-eff">-</span>%</p>
                            <p><strong>Energi PLN:</strong> <span id="debug-energy-pln">-</span> kWh</p>
                            <p><strong>Range Real:</strong> <span id="debug-range-real">-</span> km</p>
                            <p><strong>Biaya per Charge:</strong> <span id="debug-cost-charge">-</span></p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Fixed Results Sidebar for Desktop -->
            <div class="hidden lg:block fixed right-4 top-20 w-80 max-h-[85vh] overflow-y-auto z-10">
                <div class="bg-white rounded-lg shadow-xl p-6">
                    <h2 class="text-xl font-semibold text-gray-900 mb-4">📊 Hasil Perhitungan</h2>
                    
                    <!-- E-bike Costs -->
                    <div class="mb-6">
                        <h3 class="font-semibold text-ebike mb-3">💚 Biaya E-bike</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span>Per Charge:</span>
                                <span id="cost-per-charge" class="font-semibold">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Per km:</span>
                                <span id="cost-per-km" class="font-semibold">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Per Hari:</span>
                                <span id="cost-daily" class="font-semibold">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Per Minggu:</span>
                                <span id="cost-weekly" class="font-semibold">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Per Bulan:</span>
                                <span id="cost-monthly" class="font-semibold">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- Motor Costs -->
                    <div class="mb-6">
                        <h3 class="font-semibold text-motor mb-3">🔴 Biaya Motor Bensin</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span>Per Minggu:</span>
                                <span id="motor-weekly" class="font-semibold">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Per Bulan:</span>
                                <span id="motor-monthly" class="font-semibold">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- ROI Analysis -->
                    <div class="mb-6">
                        <h3 class="font-semibold text-compare mb-3">📈 Analisis ROI</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span>Penghematan/Minggu:</span>
                                <span id="savings-weekly" class="font-semibold text-green-600">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Penghematan/Bulan:</span>
                                <span id="savings-monthly" class="font-semibold text-green-600">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Penghematan/Tahun:</span>
                                <span id="savings-yearly" class="font-semibold text-green-600">-</span>
                            </div>
                        </div>
                    </div>

                    <!-- Payback Period -->
                    <div class="mb-6 p-4 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg border border-green-200">
                        <h3 class="font-semibold text-green-800 mb-3">💰 Waktu Balik Modal</h3>
                        <div class="space-y-2 text-sm">
                            <div class="text-center">
                                <div class="text-2xl font-bold text-green-700" id="payback-months">-</div>
                                <div class="text-gray-600">bulan</div>
                            </div>
                            <div class="text-center text-xs text-gray-600 mt-2">
                                <span id="payback-years">-</span>
                            </div>
                            <div class="mt-3 p-2 bg-white rounded border text-xs">
                                <p class="font-medium text-gray-700">💡 Artinya:</p>
                                <p id="payback-explanation" class="text-gray-600">-</p>
                            </div>
                        </div>
                    </div>

                    <!-- Investment Summary -->
                    <div class="p-4 bg-blue-50 rounded-lg border border-blue-200">
                        <h4 class="font-semibold text-blue-800 mb-2">📋 Ringkasan Investasi</h4>
                        <div class="text-xs text-gray-700 space-y-1">
                            <div class="flex justify-between">
                                <span>Investasi Awal:</span>
                                <span id="investment-initial" class="font-semibold">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Total Hemat 5 Tahun:</span>
                                <span id="investment-5year" class="font-semibold text-green-600">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span>ROI 5 Tahun:</span>
                                <span id="roi-5year" class="font-semibold text-blue-600">-</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mobile Results (below main content) -->
        <div class="lg:hidden mt-8">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">📊 Hasil Perhitungan</h2>
                
                <!-- E-bike Costs -->
                <div class="mb-6">
                    <h3 class="font-semibold text-ebike mb-3">💚 Biaya E-bike</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Per Charge:</span>
                            <span id="cost-per-charge-mobile" class="font-semibold">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Per km:</span>
                            <span id="cost-per-km-mobile" class="font-semibold">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Per Hari:</span>
                            <span id="cost-daily-mobile" class="font-semibold">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Per Minggu:</span>
                            <span id="cost-weekly-mobile" class="font-semibold">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Per Bulan:</span>
                            <span id="cost-monthly-mobile" class="font-semibold">-</span>
                        </div>
                    </div>
                </div>

                <!-- Motor Costs -->
                <div class="mb-6">
                    <h3 class="font-semibold text-motor mb-3">🔴 Biaya Motor Bensin</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Per Minggu:</span>
                            <span id="motor-weekly-mobile" class="font-semibold">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Per Bulan:</span>
                            <span id="motor-monthly-mobile" class="font-semibold">-</span>
                        </div>
                    </div>
                </div>

                <!-- ROI Analysis -->
                <div class="mb-6">
                    <h3 class="font-semibold text-compare mb-3">📈 Analisis ROI</h3>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Penghematan/Minggu:</span>
                            <span id="savings-weekly-mobile" class="font-semibold text-green-600">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Penghematan/Bulan:</span>
                            <span id="savings-monthly-mobile" class="font-semibold text-green-600">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Penghematan/Tahun:</span>
                            <span id="savings-yearly-mobile" class="font-semibold text-green-600">-</span>
                        </div>
                    </div>
                </div>

                <!-- Payback Period Mobile -->
                <div class="p-4 bg-gradient-to-r from-green-50 to-blue-50 rounded-lg border border-green-200">
                    <h3 class="font-semibold text-green-800 mb-3">💰 Waktu Balik Modal</h3>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-green-700" id="payback-months-mobile">-</div>
                        <div class="text-gray-600">bulan</div>
                        <div class="text-xs text-gray-600 mt-1" id="payback-years-mobile">-</div>
                    </div>
                    <div class="mt-3 p-2 bg-white rounded border text-xs">
                        <p class="font-medium text-gray-700">💡 Artinya:</p>
                        <p id="payback-explanation-mobile" class="text-gray-600">-</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Format currency in Indonesian Rupiah
        function formatCurrency(amount) {
            return new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: 'IDR',
                minimumFractionDigits: 0
            }).format(amount);
        }

        // Format number with thousand separators
        function formatNumber(num) {
            return new Intl.NumberFormat('id-ID').format(num);
        }

        // Safe get element by ID
        function safeSetContent(id, content) {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = content;
            } else {
                console.warn(`Element with ID '${id}' not found`);
            }
        }

        // Calculate all costs and ROI
        function calculateAll() {
            try {
                // Get input values
                const voltage = parseFloat(document.getElementById('voltage').value) || 48;
                const capacity = parseFloat(document.getElementById('capacity').value) || 10;
                const range = parseFloat(document.getElementById('range').value) || 40;
                const electricityRate = parseFloat(document.getElementById('electricity_rate').value) || 1467;
                const dailyDistance = parseFloat(document.getElementById('daily_distance').value) || 20;
                const activeDays = parseInt(document.getElementById('active_days').value) || 5;
                const drivingMode = parseFloat(document.getElementById('driving_mode').value) || 0.9;
                const terrain = parseFloat(document.getElementById('terrain').value) || 1.0;
                const ebikePrice = parseFloat(document.getElementById('ebike_price').value) || 15000000;
                const weeklyFuelCost = parseFloat(document.getElementById('weekly_fuel_cost').value) || 150000;

                // Calculate battery energy
                const batteryEnergyWh = voltage * capacity;
                const batteryEnergyKwh = batteryEnergyWh / 1000;

                // Charging efficiency
                const chargingEfficiency = 0.92; // 92% charging efficiency
                
                // Energy needed from PLN (termasuk loss saat charging)
                const energyFromPLN = batteryEnergyKwh / chargingEfficiency;
                
                // Cost per charge (biaya charging dari PLN)
                const costPerCharge = energyFromPLN * electricityRate;
                
                // Real range setelah driving efficiency dan terrain
                const realRange = range * drivingMode * (1 / terrain);
                
                // Cost per km
                const costPerKm = costPerCharge / realRange;

                // Calculate daily, weekly, monthly costs
                const costDaily = costPerKm * dailyDistance;
                const costWeekly = costDaily * activeDays;
                const costMonthly = costWeekly * (52/12); // Rata-rata minggu per bulan

                // Motor costs
                const motorMonthly = weeklyFuelCost * (52/12);

                // Savings calculation
                const savingsWeekly = weeklyFuelCost - costWeekly;
                const savingsMonthly = motorMonthly - costMonthly;
                const savingsYearly = savingsMonthly * 12;

                // ROI and Payback calculation
                const paybackMonths = savingsMonthly > 0 ? ebikePrice / savingsMonthly : 0;
                const paybackYears = paybackMonths / 12;
                
                // 5-year savings and ROI
                const totalSavings5Year = savingsYearly * 5;
                const roi5Year = totalSavings5Year > 0 ? ((totalSavings5Year - ebikePrice) / ebikePrice) * 100 : 0;

                // Update debug info
                safeSetContent('debug-capacity', batteryEnergyKwh.toFixed(2));
                safeSetContent('debug-mode', (drivingMode * 100).toFixed(0));
                safeSetContent('debug-terrain', terrain.toFixed(1));
                safeSetContent('debug-total-eff', (chargingEfficiency * 100).toFixed(1));
                safeSetContent('debug-energy-pln', energyFromPLN.toFixed(3));
                safeSetContent('debug-range-real', realRange.toFixed(1));
                safeSetContent('debug-cost-charge', formatCurrency(costPerCharge));

                // Update displays (desktop)
                safeSetContent('cost-per-charge', formatCurrency(costPerCharge));
                safeSetContent('cost-per-km', formatCurrency(costPerKm));
                safeSetContent('cost-daily', formatCurrency(costDaily));
                safeSetContent('cost-weekly', formatCurrency(costWeekly));
                safeSetContent('cost-monthly', formatCurrency(costMonthly));
                
                safeSetContent('motor-weekly', formatCurrency(weeklyFuelCost));
                safeSetContent('motor-monthly', formatCurrency(motorMonthly));
                
                safeSetContent('savings-weekly', formatCurrency(savingsWeekly));
                safeSetContent('savings-monthly', formatCurrency(savingsMonthly));
                safeSetContent('savings-yearly', formatCurrency(savingsYearly));

                // Payback period
                if (paybackMonths > 0 && paybackMonths < 1000) {
                    safeSetContent('payback-months', paybackMonths.toFixed(1));
                    safeSetContent('payback-years', `(${paybackYears.toFixed(1)} tahun)`);
                    
                    let explanation = "";
                    if (paybackMonths <= 12) {
                        explanation = "Investasi sangat menguntungkan! Balik modal kurang dari 1 tahun.";
                    } else if (paybackMonths <= 24) {
                        explanation = "Investasi menguntungkan! Balik modal dalam 2 tahun.";
                    } else if (paybackMonths <= 36) {
                        explanation = "Investasi cukup baik, balik modal dalam 3 tahun.";
                    } else {
                        explanation = "Investasi jangka panjang, pertimbangkan faktor lain seperti kenyamanan.";
                    }
                    safeSetContent('payback-explanation', explanation);
                } else {
                    safeSetContent('payback-months', "∞");
                    safeSetContent('payback-years', "(tidak balik modal)");
                    safeSetContent('payback-explanation', "Biaya e-bike lebih mahal dari motor bensin. Pertimbangkan manfaat lingkungan dan kenyamanan.");
                }

                // Investment summary
                safeSetContent('investment-initial', formatCurrency(ebikePrice));
                safeSetContent('investment-5year', formatCurrency(totalSavings5Year));
                safeSetContent('roi-5year', roi5Year.toFixed(1) + '%');

                // Update displays (mobile)
                safeSetContent('cost-per-charge-mobile', formatCurrency(costPerCharge));
                safeSetContent('cost-per-km-mobile', formatCurrency(costPerKm));
                safeSetContent('cost-daily-mobile', formatCurrency(costDaily));
                safeSetContent('cost-weekly-mobile', formatCurrency(costWeekly));
                safeSetContent('cost-monthly-mobile', formatCurrency(costMonthly));
                
                safeSetContent('motor-weekly-mobile', formatCurrency(weeklyFuelCost));
                safeSetContent('motor-monthly-mobile', formatCurrency(motorMonthly));
                
                safeSetContent('savings-weekly-mobile', formatCurrency(savingsWeekly));
                safeSetContent('savings-monthly-mobile', formatCurrency(savingsMonthly));
                safeSetContent('savings-yearly-mobile', formatCurrency(savingsYearly));

                // Mobile payback
                if (paybackMonths > 0 && paybackMonths < 1000) {
                    safeSetContent('payback-months-mobile', paybackMonths.toFixed(1));
                    safeSetContent('payback-years-mobile', `(${paybackYears.toFixed(1)} tahun)`);
                    
                    let explanation = "";
                    if (paybackMonths <= 12) {
                        explanation = "Investasi sangat menguntungkan! Balik modal kurang dari 1 tahun.";
                    } else if (paybackMonths <= 24) {
                        explanation = "Investasi menguntungkan! Balik modal dalam 2 tahun.";
                    } else if (paybackMonths <= 36) {
                        explanation = "Investasi cukup baik, balik modal dalam 3 tahun.";
                    } else {
                        explanation = "Investasi jangka panjang, pertimbangkan faktor lain seperti kenyamanan.";
                    }
                    safeSetContent('payback-explanation-mobile', explanation);
                } else {
                    safeSetContent('payback-months-mobile', "∞");
                    safeSetContent('payback-years-mobile', "(tidak balik modal)");
                    safeSetContent('payback-explanation-mobile', "Biaya e-bike lebih mahal dari motor bensin. Pertimbangkan manfaat lingkungan dan kenyamanan.");
                }

                console.log("Calculation completed successfully!");
            } catch (error) {
                console.error("Error in calculation:", error);
            }
        }

        // Toggle calculation details
        function toggleCalculationDetails() {
            const details = document.getElementById('calculation-details');
            const icon = document.getElementById('toggle-icon');
            const text = document.getElementById('toggle-text');
            
            if (details.classList.contains('hidden')) {
                // Show details
                details.classList.remove('hidden');
                icon.style.transform = 'rotate(180deg)';
                text.textContent = 'Klik untuk sembunyikan';
            } else {
                // Hide details
                details.classList.add('hidden');
                icon.style.transform = 'rotate(0deg)';
                text.textContent = 'Klik untuk lihat detail';
            }
        }

        // Add event listeners for real-time calculation
        function initializeCalculator() {
            const inputs = [
                'voltage', 'capacity', 'range', 'electricity_rate',
                'daily_distance', 'active_days', 'driving_mode', 'terrain',
                'ebike_price', 'weekly_fuel_cost'
            ];

            inputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('input', calculateAll);
                    element.addEventListener('change', calculateAll);
                } else {
                    console.warn(`Input element with ID '${id}' not found`);
                }
            });

            // Initial calculation
            calculateAll();
        }

        // Wait for DOM to be fully loaded
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeCalculator);
        } else {
            initializeCalculator();
        }
    </script>
</body>
</html>
